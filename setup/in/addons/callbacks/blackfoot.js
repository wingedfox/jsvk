new function () {
    var reNotBLA = /[^aehikmnopstwy]/
       ,remap={
            i:'á–-','á¤i':'á‘¯','á¨i':'á’§','á˜i':'á–-','á¢i':'á’','á¡i':'á–³','á”ˆi':'á“-',yi:'á”ª',wi:'á–³'
           ,'á–³i':'á–³áŸ','á–-i':'á–-áŸ','á–-i':'á–-áŸ','á‘«i':'á‘«áŸ','á‘­i':'á‘­áŸ','á‘-i':'á‘-áŸ','á’£i':'á’£áŸ','á’¥i':'á’¥áŸ','á’ªi':'á’ªáŸ','á–¿i':'á–¿áŸ','á–-i':'á–-áŸ','á–-i':'á–-áŸ','á’‰i':'á’‰áŸ','á’‹i':'á’‹áŸ','á’i':'á’áŸ','á–¿i':'á–¿áŸ','á–¿i':'á–¿áŸ','á–³i':'á–³áŸ','á“­i':'á“­áŸ','á“¯i':'á“¯áŸ','á“+i':'á“+áŸ','á”¦i':'á”¦áŸ','á”¨i':'á”¨áŸ','á”­i':'á”­áŸ','á–¿i':'á–¿áŸ','á–+i':'á–+áŸ','á–³i':'á–³áŸ'
           ,'á–³o':'á–³á ','á–-o':'á–-á ','á‘«o':'á‘«á ','á‘­o':'á‘­á ','á’£o':'á’£á ','á’¥o':'á’¥á ','á–¿o':'á–¿á ','á–-o':'á–-á ','á’‰o':'á’‰á ','á’‹o':'á’‹á ','á–¿o':'á–¿á ','á–¿o':'á–¿á ','á“­o':'á“­á ','á“¯o':'á“¯á ','á”¦o':'á”¦á ','á”¨o':'á”¨á ','á–¿o':'á–¿á ','á–+o':'á–+á '
        }
       ,submap={
          //s:'á'
          //nah:'á€'
            a:'á–³',e:'á–-',o:'á–-'
           ,'á¤a':'á‘«','á¤e':'á‘­','á¤o':'á‘-'
           ,'á¨a':'á’£','á¨e':'á’¥','á¨o':'á’ª'
           ,'á˜a':'á–¿','á˜e':'á–-','á˜o':'á–-'
           ,'á¢a':'á’‰','á¢e':'á’‹','á¢o':'á’'
           ,'á¡a':'á–¿','á¡e':'á–¿','á¡o':'á–³'
           ,'á”ˆa':'á“­','á”ˆe':'á“¯','á”ˆo':'á“+'
           ,ya:'á”¦',ye:'á”¨',yo:'á”­'
           ,wa:'á–¿',we:'á–+',wo:'á–³'
           ,'á¤y':'á¤y','á¨y':'á¨y','á˜y':'á˜y','á¢y':'á¢y','á¡y':'á¡y','á”ˆy':'á”ˆy'
           ,'á¤s':'á¤s','á¨s':'á¨s','á˜s':'á˜s','á¢s':'á¢s','á¡s':'á¡s','á”ˆs':'á”ˆs'
           ,'á¤w':'á¤w','á¨w':'á¨w','á˜w':'á˜w','á¢w':'á¢w','á¡w':'á¡w','á”ˆw':'á”ˆw'
           ,p:'á¤',t:'á¨',k:'á˜',m:'á¢',n:'á¡',s:'á”ˆ',h:'á‘Š'
           ,'á‘Šk':'á¦'
            //tl:1, dl:1, ts:1, ds:1, qu:1, kw:1, gw:1, hn:1
        }
       ,premap={
            'á–-o':'á–-á–-','á‘-o':'á‘-á–-','á’ªo':'á’ªá–-','á–-o':'á–-á–-','á’o':'á’á–-','á–³o':'á–³á–-','á“+o':'á“+á–-','á”­o':'á”­á–-','á–³o':'á–³á–-'
        }

    this.charProcessor = function(chr, buf){
        if (chr=='\u0008') { // backspace
            if (buf.length) {
                return [buf.slice(0,-1),buf.length-1]
            }
        } else if (reNotBLA.test(chr)) {
            return remap[buf+chr] || [buf+chr, 0]
        } else {
            var str,res,cres,h='';

            if (buf.charAt(0)=='á¦') {
                h='á‘Š';
                buf='á˜'
            }

            str=buf+chr
            if (res=remap[str]) {
                return [h+res,0]
            } else if (res=submap[str]) {
                return [h+res,res.length]
            } else if (res=premap[str]) {
                return [h+res, 1];
            } else if (res=submap[buf]) {
                if (/[á¤á¨á˜á¢á¡á”ˆ][syw][aeio]/.test(str)) {
                    res=str.charAt(0)+str.charAt(2)
                    return ([h+(remap[res]||submap[res])+{s:'á§',y:'á‘‰', w:'='}[str.charAt(1)] //chr=='i'?0:1
                            ,0])
                }
                if (cres=remap[chr])
                    return [res+cres,1];
                else
                    return [h+res+chr,1];
            } else {
                return [h+buf + (remap[chr]||submap[chr]||chr), 1]
            }
        }
    }
}
